
<source>
    type forward
    port 24224
    bind 0.0.0.0
</source>

<match *.*>
    @type stdout
</match>

<match **>
    @type copy

    <store>
        @type elasticsearch
        host "#{ENV['ELASTICSEARCH_HOSTNAME'] || 'localhost'}"
        ssl_verify "#{ENV['ELASTICSEARCH_SSL_VERIFY'] || 'true'}"
        port 443
        scheme https
        logstash_format true
        logstash_prefix rabbitmq.lab
        type_name logs.via.fluentd
    </store>

    <store>
        @type s3
        s3_bucket ecosystem.up.bucket
        s3_region eu-central-1
        utc
        path %Y/%m/%d/
        s3_object_key_format %{path}docker_lab_logs.txt
        time_slice_format %Y%m%d%H%M
        buffer_type file
        buffer_path /fluentd/log/s3
    </store>

</match>
